import{j as e}from"./ui-vendor-O7oWLmhf.js";import{a as m,b as y,L as H}from"./react-vendor-b-sydh8i.js";import{c as M,u as A,d,b as D,a as T}from"./index-D4NjjMec.js";import{m as U,p as u,B as g,u as I,q as N,g as P,k as V}from"./button-C5ouvsr7.js";/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f=U("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]),w=m.forwardRef(({className:t,...s},a)=>e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsx("table",{ref:a,className:u("w-full caption-bottom text-sm",t),...s})}));w.displayName="Table";const v=m.forwardRef(({className:t,...s},a)=>e.jsx("thead",{ref:a,className:u("[&_tr]:border-b",t),...s}));v.displayName="TableHeader";const S=m.forwardRef(({className:t,...s},a)=>e.jsx("tbody",{ref:a,className:u("[&_tr:last-child]:border-0",t),...s}));S.displayName="TableBody";const B=m.forwardRef(({className:t,...s},a)=>e.jsx("tfoot",{ref:a,className:u("border-t bg-neutral-100/50 font-medium [&>tr]:last:border-b-0 dark:bg-neutral-800/50",t),...s}));B.displayName="TableFooter";const x=m.forwardRef(({className:t,...s},a)=>e.jsx("tr",{ref:a,className:u("border-b transition-colors hover:bg-neutral-100/50 data-[state=selected]:bg-neutral-100 dark:hover:bg-neutral-800/50 dark:data-[state=selected]:bg-neutral-800",t),...s}));x.displayName="TableRow";const k=m.forwardRef(({className:t,...s},a)=>e.jsx("th",{ref:a,className:u("h-10 px-2 text-left align-middle font-medium text-gray-800 [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px] dark:text-white",t),...s}));k.displayName="TableHead";const p=m.forwardRef(({className:t,...s},a)=>e.jsx("td",{ref:a,className:u("p-2 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...s}));p.displayName="TableCell";const K=m.forwardRef(({className:t,...s},a)=>e.jsx("caption",{ref:a,className:u("mt-4 text-sm text-neutral-500 dark:text-neutral-400",t),...s}));K.displayName="TableCaption";const O=t=>{const s=typeof t=="string"?parseFloat(t):t;if(typeof s!="number"||isNaN(s))return console.warn("Invalid rank provided to getOrdinalSuffix:",t),"N/A";const a=Math.abs(Math.round(s)),o=a%10,i=a%100;if(i>=11&&i<=13)return a+"th";switch(o){case 1:return a+"st";case 2:return a+"nd";case 3:return a+"rd";default:return a+"th"}},E=t=>[{accessorKey:"name",header:({column:s})=>e.jsxs(g,{variant:"ghost",onClick:()=>s.toggleSorting(s.getIsSorted()==="asc"),children:["Name",e.jsx(f,{className:"ml-2"})]})},{accessorKey:"departments",header:({column:s})=>e.jsxs(g,{variant:"ghost",onClick:()=>s.toggleSorting(s.getIsSorted()==="asc"),children:["Departments",e.jsx(f,{className:"ml-2"})]})},{accessorKey:"total_ratings",header:({column:s})=>e.jsxs(g,{variant:"ghost",onClick:()=>s.toggleSorting(s.getIsSorted()==="asc"),children:["Total Ratings",e.jsx(f,{className:"ml-2"})]}),minSize:50,maxSize:100},{accessorKey:"empirical_bayes_average",header:({column:s})=>e.jsxs(g,{variant:"ghost",onClick:()=>s.toggleSorting(s.getIsSorted()==="asc"),children:["Rating",e.jsx(f,{className:"ml-2"})]}),cell:({row:s,getValue:a})=>{var o;return e.jsxs("strong",{children:[e.jsx("span",{style:{color:M[t].harvard},children:(o=a())==null?void 0:o.toFixed(3)}),e.jsxs("span",{children:["  (",s.original.overall_letter_grade,") (",O(s.original.empirical_bayes_rank),")"]})]})}},{accessorKey:"intra_department_metrics",header:({column:s})=>e.jsxs(g,{variant:"ghost",onClick:()=>s.toggleSorting(s.getIsSorted()==="asc"),children:["Department Metrics",e.jsx(f,{className:"ml-2"})]}),size:160,cell:({row:s})=>{const a=s.getValue("intra_department_metrics");return e.jsx("div",{children:e.jsx("div",{children:e.jsx("span",{children:a})})})}}],L=()=>e.jsx(x,{children:Array.from({length:5}).map((t,s)=>e.jsx(p,{children:e.jsx("div",{className:"h-4 w-full animate-pulse rounded bg-gray-200 dark:bg-gray-700"})},s))}),$=({data:t,isLoading:s})=>{const[a,o]=y.useState([]),[i,b]=y.useState({}),{mode:j}=A(),h=y.useMemo(()=>E(j),[j]),c=I({data:t,columns:h,onSortingChange:o,getCoreRowModel:P(),getSortedRowModel:V(),onColumnVisibilityChange:b,state:{sorting:a,columnVisibility:i},enableGlobalFilter:!0});return s?e.jsxs("div",{className:"w-full h-full flex flex-col",children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"Professor Scores (Overall)"}),e.jsx("div",{className:"rounded-md border flex-1 overflow-y-auto",children:e.jsxs(w,{className:"w-full table-fixed",children:[e.jsx(v,{children:c.getHeaderGroups().map(n=>e.jsx(x,{children:n.headers.map(r=>e.jsx(k,{className:"truncate",children:r.isPlaceholder?null:N(r.column.columnDef.header,r.getContext())},r.id))},n.id))}),e.jsx(S,{children:Array.from({length:30}).map((n,r)=>e.jsx(L,{},r))})]})})]}):e.jsxs("div",{className:"w-full h-full flex flex-col",children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"Professor Scores (Overall)"}),e.jsx("div",{className:"rounded-md border flex-1 overflow-y-auto",children:e.jsxs(w,{className:"w-full table-fixed",children:[e.jsx(v,{children:c.getHeaderGroups().map(n=>e.jsx(x,{children:n.headers.map(r=>e.jsx(k,{className:"truncate",children:r.isPlaceholder?null:N(r.column.columnDef.header,r.getContext())},r.id))},n.id))}),e.jsx(S,{children:c.getRowModel().rows.length>0?c.getRowModel().rows.map(n=>e.jsx(x,{"data-state":n.getIsSelected()&&"selected",children:n.getVisibleCells().map(r=>e.jsx(p,{children:N(r.column.columnDef.cell,r.getContext())},r.id))},n.id)):e.jsx(x,{children:e.jsx(p,{colSpan:h.length,className:"h-24 text-center",children:"No results."})})})]})})]})},q=t=>{const s=typeof t=="string"?parseFloat(t):t;if(typeof s!="number"||isNaN(s))return console.warn("Invalid rank provided to getOrdinalSuffix:",t),"N/A";const a=Math.abs(Math.round(s)),o=a%10,i=a%100;if(i>=11&&i<=13)return a+"th";switch(o){case 1:return a+"st";case 2:return a+"nd";case 3:return a+"rd";default:return a+"th"}},z=t=>[{accessorKey:"name",header:({column:s})=>e.jsxs(g,{variant:"ghost",onClick:()=>s.toggleSorting(s.getIsSorted()==="asc"),children:["Department",e.jsx(f,{className:"ml-2"})]})},{accessorKey:"empirical_bayes_average",header:({column:s})=>e.jsxs(g,{variant:"ghost",onClick:()=>s.toggleSorting(s.getIsSorted()==="asc"),children:["Average Score",e.jsx(f,{className:"ml-2"})]}),cell:({row:s,getValue:a})=>{var o;return e.jsxs("strong",{children:[e.jsx("span",{style:{color:M[t].harvard},children:(o=a())==null?void 0:o.toFixed(3)}),e.jsxs("span",{children:["  (Avg. Rank: ",q(Math.round(s.original.empirical_bayes_rank)),")"]})]})}}],G=()=>e.jsx(x,{children:Array.from({length:2}).map((t,s)=>e.jsx(p,{children:e.jsx("div",{className:"h-4 w-full animate-pulse rounded bg-gray-200 dark:bg-gray-700"})},s))}),J=({data:t,isLoading:s})=>{var n;const[a,o]=y.useState([{id:"empirical_bayes_average",desc:!0}]),[i,b]=y.useState({}),{mode:j}=A(),h=y.useMemo(()=>z(j),[j]),c=I({data:t,columns:h,state:{sorting:a,columnVisibility:i},onSortingChange:o,onColumnVisibilityChange:b,getCoreRowModel:P(),getSortedRowModel:V(),enableGlobalFilter:!0});return s?e.jsxs("div",{className:"w-full h-full flex flex-col",children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"Department Scores"}),e.jsx("div",{className:"rounded-md border flex-1 overflow-y-auto",children:e.jsxs(w,{className:"w-full table-fixed",children:[e.jsx(v,{children:c.getHeaderGroups().map(r=>e.jsx(x,{children:r.headers.map(l=>e.jsx(k,{className:"truncate",children:l.isPlaceholder?null:N(l.column.columnDef.header,l.getContext())},l.id))},r.id))}),e.jsx(S,{children:Array.from({length:30}).map((r,l)=>e.jsx(G,{},l))})]})})]}):e.jsxs("div",{className:"w-full h-full flex flex-col",children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"Department Scores"}),e.jsx("div",{className:"rounded-md border flex-1 overflow-y-auto",children:e.jsxs(w,{className:"w-full table-fixed",children:[e.jsx(v,{children:c.getHeaderGroups().map(r=>e.jsx(x,{children:r.headers.map(l=>e.jsx(k,{className:"truncate",children:l.isPlaceholder?null:N(l.column.columnDef.header,l.getContext())},l.id))},r.id))}),e.jsx(S,{children:(n=c.getRowModel().rows)!=null&&n.length?c.getRowModel().rows.map(r=>e.jsx(x,{"data-state":r.getIsSelected()&&"selected",children:r.getVisibleCells().map(l=>e.jsx(p,{children:N(l.column.columnDef.cell,l.getContext())},l.id))},r.id)):e.jsx(x,{children:e.jsx(p,{colSpan:h.length,className:"h-24 text-center",children:"No results."})})})]})})]})},ee=()=>{const[t,s]=m.useState([]),[a,o]=m.useState([]),[i,b]=m.useState(!0);return m.useEffect(()=>{(async()=>{try{const[h,c]=await Promise.all([d.professors.toArray(),d.departments.toArray()]),n=await d.metadata.get("lastUpdate");if(h.length>0&&c.length>0&&n){const _=(await D.head(`${T.apiBaseUrl}/api/professors/`)).headers["last-modified"];if(_&&new Date(_)<=new Date(n.value)){s(h),o(c),b(!1);return}}const[r,l]=await Promise.all([D.get(`${T.apiBaseUrl}/api/professors/`),D.get(`${T.apiBaseUrl}/api/departments/`)]),F=new Date().toISOString(),C=Array.isArray(r.data)?r.data:r.data.professors?[r.data.professors]:[],R=Array.isArray(l.data)?l.data:l.data.departments?[l.data.departments]:[];await d.transaction("rw",d.professors,d.departments,d.metadata,async()=>{await Promise.all([d.professors.clear(),d.departments.clear(),C.length>0&&d.professors.bulkAdd(C),R.length>0&&d.departments.bulkAdd(R),d.metadata.put({key:"lastUpdate",value:F})])}),s(C),o(R)}catch(h){console.error("Error fetching data:",h)}finally{b(!1)}})()},[]),e.jsxs("div",{className:"professors-page",children:[e.jsx("div",{className:"guide",children:e.jsx("i",{children:e.jsx(H,{to:"/about",className:"guide-link",children:'Each number is calculated via empirical bayes across every course an instructor has taught based on the "Evaluate your Instructor overall" question. Department scores are naive averages.'})})}),e.jsxs("div",{className:"professors-container",children:[e.jsx("div",{className:"section-left",children:e.jsx($,{data:t,isLoading:i})}),e.jsx("div",{className:"section-right",children:e.jsx(J,{data:a,isLoading:i})})]})]})};export{ee as default};
